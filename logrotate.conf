# Nexus log rotation configuration
# 
# ⚠️  AUTO-GENERATED FILE
# This file was generated by: python3 scripts/setup_logrotate.py
# 
# If you move the nexus directory to a different path, regenerate this file:
#   python3 scripts/setup_logrotate.py
#   python3 scripts/setup_logrotate.py --install    # Re-install to /etc/logrotate.d/
#
# For system installation, see: python3 scripts/setup_logrotate.py --help

/home/ubuntu/git/ghabs/nexus/logs/*.log {
    # Rotate daily
    daily
    
    # Keep 7 days of logs
    rotate 7
    
    # Don't error if log file is missing
    missingok
    
    # Don't rotate if log is empty
    notifempty
    
    # Compress old logs (saves disk space)
    compress
    
    # Delay compression until next rotation (keeps yesterday's log uncompressed)
    delaycompress
    
    # Create new log file with these permissions after rotation
    create 0644 ubuntu ubuntu
    
    # Use date as suffix for rotated files (e.g., audit.log-20260216)
    dateext
    dateformat -%Y%m%d
    
    # If log file is rotated while process is writing, notify the service
    postrotate
        # Send SIGHUP to processes to reopen log files (if needed)
        # For Python logging handlers, they typically handle this automatically
        systemctl reload nexus-bot.service 2>/dev/null || true
        systemctl reload nexus-processor.service 2>/dev/null || true
    endscript
    
    # Shared scripts run only once for all logs
    sharedscripts
}
